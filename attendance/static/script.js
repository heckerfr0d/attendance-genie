var txt = {
    'A': Array(),
    'B': Array(),
    'C': Array(),
    'D': Array(),
    'E': Array(),
    'F': Array(),
    'G': Array(),
    'H': Array(),
    'I': Array(),
    'J': Array(),
    'K': Array(),
    'L': Array(),
    'M': Array(),
    'N': Array(),
    'O': Array(),
    'P': Array(),
    'Q': Array(),
    'R': Array(),
    'S': Array(),
    'T': Array(),
    'U': Array(),
    'V': Array(),
    'W': Array(),
    'X': Array(),
    'Y': Array(),
    'Z': Array(),
    '.': Array(),
    ',': Array(),
    ';': Array(),
    ':': Array(),
    '\'': Array(),
    '"': Array(),
    ' ': Array(),
    '+': Array(),
    '-': Array(),
    '_': Array(),
    '[': Array(),
    ']': Array(),
    '(': Array(),
    ')': Array(),
    '<': Array(),
    '>': Array(),
    '!': Array(),
    '?': Array(),
    '*': Array()
};

var pub = Array();

txt['A'].push("    ");
txt['A'].push(" aa ");
txt['A'].push("a  a");
txt['A'].push("aaaa");
txt['A'].push("a  a");
txt['A'].push("a  a");
txt['A'].push("    ");

txt['B'].push("    ");
txt['B'].push("bbb ");
txt['B'].push("b  b");
txt['B'].push("bbbb");
txt['B'].push("b  b");
txt['B'].push("bbb ");
txt['B'].push("    ");

txt['C'].push("    ");
txt['C'].push(" cc ");
txt['C'].push("c  c");
txt['C'].push("c   ");
txt['C'].push("c  c");
txt['C'].push(" cc ");
txt['C'].push("    ");

txt['D'].push("    ");
txt['D'].push("ddd ");
txt['D'].push("d  d");
txt['D'].push("d  d");
txt['D'].push("d  d");
txt['D'].push("ddd ");
txt['D'].push("    ");

txt['E'].push("   ");
txt['E'].push("eee");
txt['E'].push("e  ");
txt['E'].push("eee");
txt['E'].push("e  ");
txt['E'].push("eee");
txt['E'].push("   ");

txt['F'].push("   ");
txt['F'].push("fff");
txt['F'].push("f  ");
txt['F'].push("fff");
txt['F'].push("f  ");
txt['F'].push("f  ");
txt['F'].push("   ");

txt['G'].push("    ");
txt['G'].push(" ggg");
txt['G'].push("g   ");
txt['G'].push("g gg");
txt['G'].push("g  g");
txt['G'].push(" gg ");
txt['G'].push("    ");

txt['H'].push("    ");
txt['H'].push("h  h");
txt['H'].push("h  h");
txt['H'].push("hhhh");
txt['H'].push("h  h");
txt['H'].push("h  h");
txt['H'].push("    ");

txt['I'].push(" ");
txt['I'].push("i");
txt['I'].push("i");
txt['I'].push("i");
txt['I'].push("i");
txt['I'].push("i");
txt['I'].push(" ");

txt['J'].push("    ");
txt['J'].push("   j");
txt['J'].push("   j");
txt['J'].push("   j");
txt['J'].push("j  j");
txt['J'].push(" jj ");
txt['J'].push("    ");

txt['K'].push("    ");
txt['K'].push("k  k");
txt['K'].push("k k ");
txt['K'].push("kk  ");
txt['K'].push("k k ");
txt['K'].push("k  k");
txt['K'].push("    ");

txt['L'].push("   ");
txt['L'].push("l  ");
txt['L'].push("l  ");
txt['L'].push("l  ");
txt['L'].push("l  ");
txt['L'].push("lll");
txt['L'].push("   ");

txt['M'].push("     ");
txt['M'].push("m   m");
txt['M'].push("mm mm");
txt['M'].push("m m m");
txt['M'].push("m   m");
txt['M'].push("m   m");
txt['M'].push("     ");

txt['N'].push("     ");
txt['N'].push("n   n");
txt['N'].push("nn  n");
txt['N'].push("n n n");
txt['N'].push("n  nn");
txt['N'].push("n   n");
txt['N'].push("     ");

txt['O'].push("    ");
txt['O'].push(" oo ");
txt['O'].push("o  o");
txt['O'].push("o  o");
txt['O'].push("o  o");
txt['O'].push(" oo ");
txt['O'].push("    ");

txt['P'].push("    ");
txt['P'].push("ppp ");
txt['P'].push("p  p");
txt['P'].push("ppp ");
txt['P'].push("p   ");
txt['P'].push("p   ");
txt['P'].push("    ");

txt['Q'].push("    ");
txt['Q'].push(" qq ");
txt['Q'].push("q  q");
txt['Q'].push("q  q");
txt['Q'].push("q  q");
txt['Q'].push(" qq ");
txt['Q'].push("   q");

txt['R'].push("    ");
txt['R'].push("rrr ");
txt['R'].push("r  r");
txt['R'].push("rrr ");
txt['R'].push("r r ");
txt['R'].push("r  r");
txt['R'].push("    ");

txt['S'].push("    ");
txt['S'].push(" sss");
txt['S'].push("s   ");
txt['S'].push(" ss ");
txt['S'].push("   s");
txt['S'].push("sss ");
txt['S'].push("    ");

txt['T'].push("   ");
txt['T'].push("ttt");
txt['T'].push(" t ");
txt['T'].push(" t ");
txt['T'].push(" t ");
txt['T'].push(" t ");
txt['T'].push("   ");

txt['U'].push("    ");
txt['U'].push("u  u");
txt['U'].push("u  u");
txt['U'].push("u  u");
txt['U'].push("u  u");
txt['U'].push(" uu ");
txt['U'].push("    ");

txt['V'].push("     ");
txt['V'].push("v   v");
txt['V'].push("v   v");
txt['V'].push(" v v ");
txt['V'].push(" v v ");
txt['V'].push("  v  ");
txt['V'].push("     ");

txt['W'].push("     ");
txt['W'].push("w   w");
txt['W'].push("w w w");
txt['W'].push("w w w");
txt['W'].push("w w w");
txt['W'].push(" w w ");
txt['W'].push("     ");

txt['X'].push("     ");
txt['X'].push("x   x");
txt['X'].push(" x x ");
txt['X'].push("  x  ");
txt['X'].push(" x x ");
txt['X'].push("x   x");
txt['X'].push("     ");

txt['Y'].push("     ");
txt['Y'].push("y   y");
txt['Y'].push(" y y ");
txt['Y'].push("  y  ");
txt['Y'].push("  y  ");
txt['Y'].push("  y  ");
txt['Y'].push("     ");

txt['Z'].push("   ");
txt['Z'].push("zzz");
txt['Z'].push("  z");
txt['Z'].push(" z ");
txt['Z'].push("z  ");
txt['Z'].push("zzz");
txt['Z'].push("   ");

txt['.'].push(" ");
txt['.'].push(" ");
txt['.'].push(" ");
txt['.'].push(" ");
txt['.'].push(" ");
txt['.'].push(".");
txt['.'].push(" ");

txt[','].push("  ");
txt[','].push("  ");
txt[','].push("  ");
txt[','].push("  ");
txt[','].push("  ");
txt[','].push(" ,");
txt[','].push(", ");

txt[';'].push("  ");
txt[';'].push("  ");
txt[';'].push(" ;");
txt[';'].push("  ");
txt[';'].push(" ;");
txt[';'].push("; ");
txt[';'].push("  ");

txt[':'].push(" ");
txt[':'].push(" ");
txt[':'].push(":");
txt[':'].push(" ");
txt[':'].push(":");
txt[':'].push(" ");
txt[':'].push(" ");

txt['('].push("  ");
txt['('].push(" (");
txt['('].push("( ");
txt['('].push("( ");
txt['('].push("( ");
txt['('].push(" (");
txt['('].push("  ");

txt[')'].push("  ");
txt[')'].push(") ");
txt[')'].push(" )");
txt[')'].push(" )");
txt[')'].push(" )");
txt[')'].push(") ");
txt[')'].push("  ");

txt['['].push("  ");
txt['['].push("[[");
txt['['].push("[ ");
txt['['].push("[ ");
txt['['].push("[ ");
txt['['].push("[[");
txt['['].push("  ");

txt[']'].push("  ");
txt[']'].push("]]");
txt[']'].push(" ]");
txt[']'].push(" ]");
txt[']'].push(" ]");
txt[']'].push("]]");
txt[']'].push("  ");

txt['<'].push("   ");
txt['<'].push("  <");
txt['<'].push(" < ");
txt['<'].push("<  ");
txt['<'].push(" < ");
txt['<'].push("  <");
txt['<'].push("   ");

txt['>'].push("   ");
txt['>'].push(">  ");
txt['>'].push(" > ");
txt['>'].push("  >");
txt['>'].push(" > ");
txt['>'].push(">  ");
txt['>'].push("   ");

txt['!'].push(" ");
txt['!'].push("!");
txt['!'].push("!");
txt['!'].push("!");
txt['!'].push(" ");
txt['!'].push("!");
txt['!'].push(" ");

txt['?'].push("    ");
txt['?'].push("??? ");
txt['?'].push("   ?");
txt['?'].push(" ?? ");
txt['?'].push("    ");
txt['?'].push(" ?  ");
txt['?'].push("    ");

txt['+'].push("   ");
txt['+'].push("   ");
txt['+'].push(" + ");
txt['+'].push("+++");
txt['+'].push(" + ");
txt['+'].push("   ");
txt['+'].push("   ");

txt['-'].push("  ");
txt['-'].push("  ");
txt['-'].push("  ");
txt['-'].push("--");
txt['-'].push("  ");
txt['-'].push("  ");
txt['-'].push("  ");

txt['_'].push("   ");
txt['_'].push("   ");
txt['_'].push("   ");
txt['_'].push("   ");
txt['_'].push("   ");
txt['_'].push("___");
txt['_'].push("   ");

txt['*'].push("     ");
txt['*'].push("  *  ");
txt['*'].push("* * *");
txt['*'].push(" *** ");
txt['*'].push("* * *");
txt['*'].push("  *  ");
txt['*'].push("     ");

txt['\''].push(" ");
txt['\''].push("'");
txt['\''].push("'");
txt['\''].push(" ");
txt['\''].push(" ");
txt['\''].push(" ");
txt['\''].push(" ");

txt[' '].push(" ");
txt[' '].push(" ");
txt[' '].push(" ");
txt[' '].push(" ");
txt[' '].push(" ");
txt[' '].push(" ");
txt[' '].push(" ");

function toggle(elem) {
    var $radios = elem.parent().find('input[type="radio"]');
    var colorClasses = ["btn-secondary c0", "btn-secondary c1", "btn-secondary c2"];
    var $checked = $radios.filter(':checked');
    var $next = $radios.eq($radios.index($checked[0]) + 1);
    if (!$next.length) {
        $next = $radios.first();
    }
    $next.prop("checked", true);
    var newValue = $radios.filter(':checked').val();
    $(elem)
        .removeClass(colorClasses.join(" "))
        .addClass(colorClasses[newValue]);
}

function findw(text) {
    var w = 0;
    for (var c in text) {
        if (text[c] in txt)
            w += txt[text[c]][0].length + 1;
        else if (text[c].toUpperCase() in txt)
            w += txt[text[c].toUpperCase()][0].length + 1;
    }
    return w - 1;
}

function render(trans, text) {
    var w = findw(text);
    if (w > 52)
        alert("You typed too long");
    else {
        var offset = (((52 - w) / 2) >> 0);
        for (var c in text) {
            if (!(text[c] in txt) && text[c].toUpperCase() in txt)
                text = text.replaceAll(text[c], text[c].toUpperCase());
            if (text[c] in txt) {
                for (var k = 0; k < 7; k++)
                    for (var j = offset; j < offset + (txt[text[c]][0].length); j++)
                        if (txt[text[c]][k][j - offset] != ' ')
                            toggle(trans.parent().find('button[name="' + String(k) + ' ' + String(j) + '"]'));
                offset += txt[text[c]][0].length;
                if (c != ' ')
                    offset++;
            }
        }
    }
}

$('input[name="translate"]').click(function () {
    var text = $(this).parent().find('input[name="ttg"]').val();
    for (var i in pub) {
        if (text.includes(pub[i])) {
            txt['~'] = txt[pub[i]];
            text = text.replaceAll(pub[i], '~');
        }
    }
    render($(this), text);
});

$('input[name="clear"]').click(function () {
    var $buttons = $(this).parent().find('button[type="button"]');
    for (i in $buttons) {
        var $radio = $('input[type="radio"][name="' + $buttons[i].name + '"][value="0"]');
        $radio.prop("checked", true);
        $buttons[i].className = "btn btn-secondary c0";
    }
});

$('input[name="invert"]').click(function () {
    var buttons = $(this).parent().find('button[type="button"]');
    for (var i in buttons)
    {
        if($(buttons[i]).attr('name'))
            toggle($(buttons[i]));
    }
});

$('input[name="ttg"]').on('keypress', function(event) {
    var keyCode = event.keyCode || event.which;
    if (keyCode === 13) {
      event.preventDefault();
      $(this).next().click();
    }
  });

$('#dismiss').click( function () {
    $(this).parent().hide();
});

let action = null;

$("button[class!=\"tr\"]").mousedown(function () {
    toggle($(this));
    action = "not null";
});

$(document).on("mouseup", function (event) {
    action = null;
});

$("button[class!=\"tr\"]").on("mouseup click", function (event) {
    event.preventDefault();
    action = null;
});

$("button[class!=\"tr\"]").mouseenter(function (event) {
    if (action)
        toggle($(this));
});


let theme = localStorage.getItem("theme")

if (theme && theme === 'light') {
    console.log('Light theme')
    document.getElementById("checkbox").checked = true
    document.documentElement.setAttribute('theme', 'light');
    document.getElementsByClassName("nextTheme")[0].innerHTML = "Light Mode";
}

const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');

function changeTheme(e) {
    if (e.target.checked) {
        document.documentElement.setAttribute('theme', 'light');
        document.getElementsByClassName("nextTheme")[0].innerHTML = "Light Mode";
        localStorage.setItem('theme', 'light')
    }
    else {
        document.documentElement.setAttribute('theme', 'dark');
        document.getElementsByClassName("nextTheme")[0].innerHTML = "Dark Mode";
        localStorage.setItem('theme', 'dark')
    }
}

toggleSwitch.addEventListener('change', changeTheme, false);

txt['annen'] = [
	'                                                  ',
	' ##  #   # #   # ### #   #   #   # ###  ###  ### #',
	'#  # ##  # ##  # #   ##  #   ## ## #   #    #    #',
	'#### # # # # # # ### # # #   # # # ###  ##   ##  #',
	'#  # #  ## #  ## #   #  ##   #   # #      #    #  ',
	'#  # #   # #   # ### #   #   #   # ### ###  ###  #',
	'                                                  '
];
pub.push('annen');

txt['<3'] = [
	'     ',
	'     ',
	'## ##',
	'#####',
	' ### ',
	'  #  ',
	'     '
];
pub.push('<3');

txt['a'] = [
	'     ',
	'     ',
	' ##  ',
	'#  # ',
	'#  # ',
	' ## #',
	'     '
];

txt['b'] = [
	'   ',
	'#  ',
	'#  ',
	'## ',
	'# #',
	'## ',
	'   '
];
